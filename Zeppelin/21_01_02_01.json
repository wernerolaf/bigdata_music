{"paragraphs":[{"text":"%pyspark\nimport pyspark\nfrom pyspark.sql import HiveContext\n\nsqlsc = HiveContext(sc)\n# sqlsc = pyspark.sql.SQLContext(sc)","dateUpdated":"Jan 16, 2021 7:05:56 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610107048339_1783195897","id":"20210108-115728_2101218613","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jan 8, 2021 11:57:28 AM","dateStarted":"Jan 16, 2021 7:05:56 PM","dateFinished":"Jan 16, 2021 7:09:32 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58"},{"text":"%pyspark\ndf_w_a = sqlsc.read.format('json').load('/user/bigdata_music/wikidata/')\ndf_w_a = df_w_a.dropDuplicates()","dateUpdated":"Jan 16, 2021 7:05:56 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610738515312_-515661940","id":"20210115-192155_1856093961","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jan 15, 2021 7:21:55 PM","dateStarted":"Jan 16, 2021 7:06:03 PM","dateFinished":"Jan 16, 2021 7:10:05 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:59"},{"text":"%pyspark\ndf_s_a = sqlsc.read.format('json').load('/user/bigdata_music/spotify/*')","dateUpdated":"Jan 16, 2021 7:05:56 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610741656823_-699679781","id":"20210115-201416_1605529912","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jan 15, 2021 8:14:16 PM","dateStarted":"Jan 16, 2021 7:09:33 PM","dateFinished":"Jan 16, 2021 7:10:07 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:60"},{"text":"%pyspark\nprint((df_w_a.count(), len(df_w_a.columns)))\nprint(df_w_a.show(16))","dateUpdated":"Jan 16, 2021 7:05:57 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610741257431_2142661203","id":"20210115-200737_1732381424","result":{"code":"SUCCESS","type":"TEXT","msg":"(3128, 11)\n+---+--------------------+------------+--------------------+------+----------------+--------------------+--------------------+--------------------+-----------------+-------------+\n|age|               birth|  birthplace|               death|gender|           genre|               human|                  id|          instrument|          knownAs|    pseudonym|\n+---+--------------------+------------+--------------------+------+----------------+--------------------+--------------------+--------------------+-----------------+-------------+\n| 32|1989-09-21T00:00:00Z|     Miramar|                    |  male|contemporary R&B|http://www.wikida...|07YZf4WDAMNwqr4jf...|               piano|     Jason Derulo| Jason Derulo|\n| 37|1984-01-17T00:00:00Z|    Dumfries|                    |  male|      electropop|http://www.wikida...|7CajNmpbOovFoOoas...|         bass guitar|    Calvin Harris|Calvin Harris|\n| 20|1998-01-23T00:00:00Z|  Plantation|2018-06-18T00:00:00Z|  male|         emo rap|http://www.wikida...|15UsOTVnJzReFVN1V...|              guitar|     XXXTentacion|          XXX|\n| 30|1991-09-11T00:00:00Z|   Singapore|                    |  male|     house music|http://www.wikida...|23fqKkggKUBHNkbKt...|               piano|             Kygo|          â€»|\n| 39|1982-02-25T00:00:00Z|       Provo|                    |  male|         screamo|http://www.wikida...|6ulyIBuifBzU35Rsv...|         grand piano|   Bert McCracken|             |\n| 37|1984-10-19T00:00:00Z| Los Angeles|                    |  male|electronic music|http://www.wikida...|4frXpPxQQZwbCu3eT...|         bass guitar|       Thundercat|             |\n| 43|1978-03-29T00:00:00Z|      London|                    |  male|        shoegaze|http://www.wikida...|4aEnNH9PuU1HF3TsZ...|         synthesizer|       Dan Snaith|       Daphni|\n| 39|1982-02-25T00:00:00Z|       Provo|                    |  male|   post-hardcore|http://www.wikida...|6ulyIBuifBzU35Rsv...|               voice|   Bert McCracken|             |\n| 43|1978-03-29T00:00:00Z|      London|                    |  male|      deep house|http://www.wikida...|4aEnNH9PuU1HF3TsZ...|              guitar|       Dan Snaith|       Daphni|\n| 46|1975-07-01T00:00:00Z|     Detroit|                    |  male|      indie folk|http://www.wikida...|4MXUO7sVCaFgFjoTI...|percussion instru...|   Sufjan Stevens|             |\n| 62|1959-04-10T00:00:00Z|Indianapolis|                    |  male|  new jack swing|http://www.wikida...|3aVoqlJOYx31lH1gi...|              guitar|         Babyface|     Babyface|\n| 34|1987-03-01T00:00:00Z| Los Angeles|                    |female|       synth-pop|http://www.wikida...|6LqNN22kT3074XbTV...|               voice|            Kesha|             |\n| 40|1981-01-31T00:00:00Z|     Memphis|                    |  male|contemporary R&B|http://www.wikida...|31TPClRtHm23RisEB...|               voice|Justin Timberlake|           JT|\n| 28|1993-06-26T00:00:00Z|  Boca Raton|                    |female|rhythm and blues|http://www.wikida...|66CXWjxzNUsdJxJ2J...|               voice|    Ariana Grande|             |\n| 37|1984-01-17T00:00:00Z|    Dumfries|                    |  male|   electro house|http://www.wikida...|7CajNmpbOovFoOoas...|         bass guitar|    Calvin Harris|Calvin Harris|\n| 37|1984-01-17T00:00:00Z|    Dumfries|                    |  male|      electropop|http://www.wikida...|7CajNmpbOovFoOoas...|              guitar|    Calvin Harris|Calvin Harris|\n+---+--------------------+------------+--------------------+------+----------------+--------------------+--------------------+--------------------+-----------------+-------------+\nonly showing top 16 rows\n\nNone\n"},"dateCreated":"Jan 15, 2021 8:07:37 PM","dateStarted":"Jan 16, 2021 7:10:05 PM","dateFinished":"Jan 16, 2021 7:10:31 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:61"},{"text":"%pyspark\nfrom pyspark.sql import functions as F","dateUpdated":"Jan 16, 2021 7:05:57 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610742660328_-874149989","id":"20210115-203100_1621053403","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jan 15, 2021 8:31:00 PM","dateStarted":"Jan 16, 2021 7:10:08 PM","dateFinished":"Jan 16, 2021 7:10:31 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:62"},{"text":"%pyspark\nprint(F.collect_list)","dateUpdated":"Jan 16, 2021 7:05:57 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610742756048_-1721028291","id":"20210115-203236_1606549136","result":{"code":"SUCCESS","type":"TEXT","msg":"<function collect_list at 0x19539b0>\n"},"dateCreated":"Jan 15, 2021 8:32:36 PM","dateStarted":"Jan 16, 2021 7:10:31 PM","dateFinished":"Jan 16, 2021 7:10:31 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:63"},{"text":"%pyspark\nprint((df_s_a.count(), len(df_s_a.columns)))\nprint(df_s_a.show(19))","dateUpdated":"Jan 16, 2021 7:05:57 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610741289895_-1573213026","id":"20210115-200809_279203773","result":{"code":"SUCCESS","type":"TEXT","msg":"(1626, 10)\n+--------------------+---------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+------+--------------------+\n|       external_urls|      followers|              genres|                href|                  id|              images|                name|popularity|  type|                 uri|\n+--------------------+---------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+------+--------------------+\n|[https://open.spo...|   [null,95030]|[czech pop, polis...|https://api.spoti...|6xajh3A5qhxsNffhh...|[[640,https://i.s...|           Ewa Farna|        51|artist|spotify:artist:6x...|\n|[https://open.spo...|[null,12316852]|[sertanejo univer...|https://api.spoti...|3p7PcrEHaaKLJnPUG...|[[640,https://i.s...|  Henrique & Juliano|        83|artist|spotify:artist:3p...|\n|[https://open.spo...|  [null,110445]|[polish hip hop, ...|https://api.spoti...|1MZ1TtfmzMHEYIlyn...|[[640,https://i.s...|                Gedz|        63|artist|spotify:artist:1M...|\n|[https://open.spo...|    [null,1562]|                  []|https://api.spoti...|3kyJLSOihpXaaR1NB...|[[640,https://i.s...|            Madumane|        48|artist|spotify:artist:3k...|\n|[https://open.spo...|  [null,195062]|[art pop, bubbleg...|https://api.spoti...|4wXchxfTTggLtzkoU...|[[640,https://i.s...|        Soccer Mommy|        61|artist|spotify:artist:4w...|\n|[https://open.spo...| [null,2181495]|[alternative rock...|https://api.spoti...|3jOstUTkEu2JkjvRd...|[[640,https://i.s...|              Weezer|        75|artist|spotify:artist:3j...|\n|[https://open.spo...|   [null,27631]|       [houston rap]|https://api.spoti...|28Jt29jw6Smc3ZkzA...|[[640,https://i.s...|            DJ Chose|        64|artist|spotify:artist:28...|\n|[https://open.spo...|  [null,189379]|[polish hip hop, ...|https://api.spoti...|7FwxJtVorL07N6kbq...|[[640,https://i.s...|              PlanBe|        60|artist|spotify:artist:7F...|\n|[https://open.spo...|   [null,13328]|         [scandipop]|https://api.spoti...|5Wg2b4Mp42gicxEeD...|[[640,https://i.s...|                 A7S|        78|artist|spotify:artist:5W...|\n|[https://open.spo...|   [null,71817]|[alternative r&b,...|https://api.spoti...|1R4GxRuSVTPSb6oy5...|[[640,https://i.s...|Gabriel Garzón-Mo...|        49|artist|spotify:artist:1R...|\n|[https://open.spo...|    [null,8289]|                  []|https://api.spoti...|5czbzNZZfWpyFgZyf...|[[640,https://i.s...|           SIDEPIECE|        70|artist|spotify:artist:5c...|\n|[https://open.spo...|    [null,1726]|                  []|https://api.spoti...|5YmtXtYdmTZDjJB9k...|[[640,https://i.s...|           D3Mstreet|        52|artist|spotify:artist:5Y...|\n|[https://open.spo...| [null,3328600]|[album rock, birm...|https://api.spoti...|6ZLTlhejhndI4Rh53...|[[640,https://i.s...|       Ozzy Osbourne|        75|artist|spotify:artist:6Z...|\n|[https://open.spo...| [null,9048479]|[dance pop, elect...|https://api.spoti...|63yrD80RY3RNEM2YD...|[[640,https://i.s...|    Melanie Martinez|        82|artist|spotify:artist:63...|\n|[https://open.spo...|   [null,15006]|[bass house, deep...|https://api.spoti...|7kNqXtgeIwFtelmRj...|[[640,https://i.s...|         John Summit|        64|artist|spotify:artist:7k...|\n|[https://open.spo...| [null,1548305]|[boston hip hop, ...|https://api.spoti...|6C1ohJrd5VydigQta...|[[640,https://i.s...|        Joyner Lucas|        78|artist|spotify:artist:6C...|\n|[https://open.spo...|   [null,34167]|[background music...|https://api.spoti...|1yLIaxyVkZnLMXhfR...|[[640,https://i.s...|    Johannes Bornlöf|        65|artist|spotify:artist:1y...|\n|[https://open.spo...|    [null,4481]|    [polish hip hop]|https://api.spoti...|6YFFJXCSmDv4SJEi0...|[[640,https://i.s...|              Matheo|        55|artist|spotify:artist:6Y...|\n|[https://open.spo...|  [null,890595]|[dance pop, hip h...|https://api.spoti...|1W3FSF1BLpY3hlVIg...|[[640,https://i.s...|           The-Dream|        67|artist|spotify:artist:1W...|\n+--------------------+---------------+--------------------+--------------------+--------------------+--------------------+--------------------+----------+------+--------------------+\nonly showing top 19 rows\n\nNone\n"},"dateCreated":"Jan 15, 2021 8:08:09 PM","dateStarted":"Jan 16, 2021 7:10:31 PM","dateFinished":"Jan 16, 2021 7:10:33 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:64"},{"text":"%pyspark\ndf_s_a_subset = df_s_a.drop('external_urls').drop('href').drop('images').drop('type').drop('uri')\ndf_s_a_subset = df_s_a_subset.dropDuplicates()\n","dateUpdated":"Jan 16, 2021 7:05:57 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610803180209_1027060135","id":"20210116-131940_868600318","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jan 16, 2021 1:19:40 PM","dateStarted":"Jan 16, 2021 7:10:32 PM","dateFinished":"Jan 16, 2021 7:10:34 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:65"},{"text":"%pyspark\ndf_s_a_subset = df_s_a_subset.withColumn(\"followers\", df_s_a_subset[\"followers\"].getItem('total'))\ndf_s_a_subset = df_s_a_subset.withColumnRenamed(\"genres\", \"spotify_genres\")\ndf_s_a_subset.show()","dateUpdated":"Jan 16, 2021 7:05:57 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610807394641_-1136545515","id":"20210116-142954_1517327396","result":{"code":"SUCCESS","type":"TEXT","msg":"+---------+--------------------+--------------------+--------------------+----------+\n|followers|      spotify_genres|                  id|                name|popularity|\n+---------+--------------------+--------------------+--------------------+----------+\n|    23509|        [polish pop]|6EtPFq0WhAq7kzcry...|         Ania Karwan|        43|\n|     4774|[baroque ensemble...|6dxdut9Mhu7r7SM9H...|       Concerto Köln|        52|\n|    74572|[bebop, contempor...|3uaHfXYx9Fh4HjqMb...|       Joshua Redman|        49|\n|      396|                  []|1gaWqnGdl91TwTbne...|           Andy Ward|        38|\n|  2146067|[k-pop, k-pop gir...|5RR0MLwcjc87wjSw2...|            MOMOLAND|        62|\n|    15519|[contemporary jaz...|2UGL8QDKTSVXMqZqQ...|Marcin Wasilewski...|        47|\n|       63|                  []|4UIoKjy2znMogM0if...|        Petr Limonov|        36|\n|    33503|[djent, progressi...|1HQjBwlj8FSHMhVaN...|                VOLA|        46|\n|   231177|[cali rap, hyphy,...|2ZavqCJe7uqkRpISe...|              Iamsu!|        64|\n|     6178|  [baltic classical]|1luoTtYQjMoJPSzl9...|     Ēriks Ešenvalds|        39|\n|   599922|[dance pop, destr...|61lyPtntblHJvA7FM...|         Duke Dumont|        71|\n|   250499|        [uk hip hop]|6UCQYrcJ6wab6gnQ8...|          Headie One|        76|\n|      259|                  []|0O6nRPrw4sAbf4bgu...|             Azulina|        48|\n|     2780|[polish hip hop, ...|0iBTVnJ1Sff92zCDu...|        Young Leosia|        54|\n|    56833|        [polish pop]|6VKh8iOViFBI7R8Bb...|      Kasia Kowalska|        45|\n|   631281|[edm, progressive...|10gzBoINW3cLJfZUk...|      Above & Beyond|        68|\n|   326247|[bass house, deep...|1KpCi9BOfviCVhmpI...|              Tchami|        66|\n|       57|                  []|1VFGLQHXOKyzfPDf9...|       Life Line Hub|        47|\n|  3942401|[album rock, art ...|5NGO30tJxFlKixkPS...|          The Police|        78|\n|   273793|[afro house, afro...|18CJ8k3h2Rggioow0...|     Cassper Nyovest|        51|\n+---------+--------------------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\n"},"dateCreated":"Jan 16, 2021 2:29:54 PM","dateStarted":"Jan 16, 2021 7:10:34 PM","dateFinished":"Jan 16, 2021 7:10:39 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:66"},{"text":"%pyspark\nprint(df_s_a_subset.dtypes)\nprint(df_s_a_subset.show())","dateUpdated":"Jan 16, 2021 7:05:57 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610741741453_1315336697","id":"20210115-201541_2141610468","result":{"code":"SUCCESS","type":"TEXT","msg":"[('followers', 'bigint'), ('spotify_genres', 'array<string>'), ('id', 'string'), ('name', 'string'), ('popularity', 'bigint')]\n+---------+--------------------+--------------------+--------------------+----------+\n|followers|      spotify_genres|                  id|                name|popularity|\n+---------+--------------------+--------------------+--------------------+----------+\n|    23509|        [polish pop]|6EtPFq0WhAq7kzcry...|         Ania Karwan|        43|\n|     4774|[baroque ensemble...|6dxdut9Mhu7r7SM9H...|       Concerto Köln|        52|\n|    74572|[bebop, contempor...|3uaHfXYx9Fh4HjqMb...|       Joshua Redman|        49|\n|      396|                  []|1gaWqnGdl91TwTbne...|           Andy Ward|        38|\n|  2146067|[k-pop, k-pop gir...|5RR0MLwcjc87wjSw2...|            MOMOLAND|        62|\n|    15519|[contemporary jaz...|2UGL8QDKTSVXMqZqQ...|Marcin Wasilewski...|        47|\n|       63|                  []|4UIoKjy2znMogM0if...|        Petr Limonov|        36|\n|    33503|[djent, progressi...|1HQjBwlj8FSHMhVaN...|                VOLA|        46|\n|   231177|[cali rap, hyphy,...|2ZavqCJe7uqkRpISe...|              Iamsu!|        64|\n|     6178|  [baltic classical]|1luoTtYQjMoJPSzl9...|     Ēriks Ešenvalds|        39|\n|   599922|[dance pop, destr...|61lyPtntblHJvA7FM...|         Duke Dumont|        71|\n|   250499|        [uk hip hop]|6UCQYrcJ6wab6gnQ8...|          Headie One|        76|\n|      259|                  []|0O6nRPrw4sAbf4bgu...|             Azulina|        48|\n|     2780|[polish hip hop, ...|0iBTVnJ1Sff92zCDu...|        Young Leosia|        54|\n|    56833|        [polish pop]|6VKh8iOViFBI7R8Bb...|      Kasia Kowalska|        45|\n|   631281|[edm, progressive...|10gzBoINW3cLJfZUk...|      Above & Beyond|        68|\n|   326247|[bass house, deep...|1KpCi9BOfviCVhmpI...|              Tchami|        66|\n|       57|                  []|1VFGLQHXOKyzfPDf9...|       Life Line Hub|        47|\n|  3942401|[album rock, art ...|5NGO30tJxFlKixkPS...|          The Police|        78|\n|   273793|[afro house, afro...|18CJ8k3h2Rggioow0...|     Cassper Nyovest|        51|\n+---------+--------------------+--------------------+--------------------+----------+\nonly showing top 20 rows\n\nNone\n"},"dateCreated":"Jan 15, 2021 8:15:41 PM","dateStarted":"Jan 16, 2021 7:10:35 PM","dateFinished":"Jan 16, 2021 7:10:46 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:67"},{"text":"%pyspark\ndf_w_a_flat = df_w_a.groupBy('id').agg(F.collect_set(df_w_a.genre).alias('wikidata_genres'))\ndf_w_a_instruments = df_w_a.groupBy('id').agg(F.collect_set(df_w_a.instrument).alias('instruments'))\nprint(df_w_a_flat.columns)\nprint(df_w_a_instruments.columns)","dateUpdated":"Jan 16, 2021 7:05:57 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610741801530_-572718101","id":"20210115-201641_1024877996","result":{"code":"SUCCESS","type":"TEXT","msg":"['id', 'wikidata_genres']\n['id', 'instruments']\n"},"dateCreated":"Jan 15, 2021 8:16:41 PM","dateStarted":"Jan 16, 2021 7:10:40 PM","dateFinished":"Jan 16, 2021 7:10:51 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:68"},{"text":"%pyspark\nprint(df_w_a_flat.dtypes)\nprint(df_w_a_flat.count())\nprint(df_w_a_flat.show(6))\nprint(df_w_a_instruments.show(6))","dateUpdated":"Jan 16, 2021 7:05:57 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610746473691_-100967285","id":"20210115-213433_1286693231","result":{"code":"SUCCESS","type":"TEXT","msg":"[('id', 'string'), ('wikidata_genres', 'array<string>')]\n385\n+--------------------+--------------------+\n|                  id|     wikidata_genres|\n+--------------------+--------------------+\n|2jku7tDXc6XoB6MO2...|     [hip hop music]|\n|4aEnNH9PuU1HF3TsZ...|[shoegaze, deep h...|\n|5T0MSzX9RC5NA6gAI...|[reggae, hip hop ...|\n|17hR0sYHpx7VYTMRf...|[Western classica...|\n|2RdwBSPQiwcmiDo9k...|[funk, contempora...|\n|6sHCvZe1PHrOAuYlw...|         [pop music]|\n+--------------------+--------------------+\nonly showing top 6 rows\n\nNone\n+--------------------+--------------------+\n|                  id|         instruments|\n+--------------------+--------------------+\n|2jku7tDXc6XoB6MO2...|             [voice]|\n|4aEnNH9PuU1HF3TsZ...|[synthesizer, gui...|\n|5T0MSzX9RC5NA6gAI...|                  []|\n|17hR0sYHpx7VYTMRf...|             [piano]|\n|2RdwBSPQiwcmiDo9k...|[voice, guitar, s...|\n|6sHCvZe1PHrOAuYlw...|                  []|\n+--------------------+--------------------+\nonly showing top 6 rows\n\nNone\n"},"dateCreated":"Jan 15, 2021 9:34:33 PM","dateStarted":"Jan 16, 2021 7:10:47 PM","dateFinished":"Jan 16, 2021 7:11:50 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:69"},{"text":"%pyspark\nprint(type(df_w_a_flat))\ndf_w_a_gr = df_w_a.drop('instrument').drop('genre').drop('pseudonym').distinct()\ndf_w_a_flat = df_w_a_flat.join(df_w_a_gr, 'id', 'left')\ndf_w_a_flat = df_w_a_flat.join(df_w_a_instruments, 'id', 'left')","dateUpdated":"Jan 16, 2021 7:05:58 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610741994284_-1570327671","id":"20210115-201954_1021913279","result":{"code":"SUCCESS","type":"TEXT","msg":"<class 'pyspark.sql.dataframe.DataFrame'>\n"},"dateCreated":"Jan 15, 2021 8:19:54 PM","dateStarted":"Jan 16, 2021 7:10:51 PM","dateFinished":"Jan 16, 2021 7:11:51 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:70"},{"text":"%pyspark\nprint(df_w_a_flat.dtypes)\nprint(df_w_a_flat.count())","dateUpdated":"Jan 16, 2021 7:05:58 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610747199785_400133066","id":"20210115-214639_1843274533","result":{"code":"SUCCESS","type":"TEXT","msg":"[('id', 'string'), ('wikidata_genres', 'array<string>'), ('age', 'bigint'), ('birth', 'string'), ('birthplace', 'string'), ('death', 'string'), ('gender', 'string'), ('human', 'string'), ('knownAs', 'string'), ('instruments', 'array<string>')]\n389\n"},"dateCreated":"Jan 15, 2021 9:46:39 PM","dateStarted":"Jan 16, 2021 7:11:51 PM","dateFinished":"Jan 16, 2021 7:13:00 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:71"},{"text":"%pyspark\ndf_f = df_w_a_flat.join(df_s_a_subset, 'id', 'right')","dateUpdated":"Jan 16, 2021 7:05:58 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610745167871_-568518753","id":"20210115-211247_781551465","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jan 15, 2021 9:12:47 PM","dateStarted":"Jan 16, 2021 7:11:52 PM","dateFinished":"Jan 16, 2021 7:13:00 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:72"},{"text":"%pyspark\nprint(df_f.count())","dateUpdated":"Jan 16, 2021 7:05:58 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610744672177_625480798","id":"20210115-210432_1646185397","result":"org.apache.thrift.transport.TTransportException","dateCreated":"Jan 15, 2021 9:04:32 PM","dateStarted":"Jan 16, 2021 7:13:00 PM","dateFinished":"Jan 16, 2021 7:13:53 PM","status":"ERROR","errorMessage":"org.apache.thrift.transport.TTransportException\n\tat org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)\n\tat org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)\n\tat org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:429)\n\tat org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:318)\n\tat org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:219)\n\tat org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:69)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$Client.recv_interpret(RemoteInterpreterService.java:220)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$Client.interpret(RemoteInterpreterService.java:205)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.interpret(RemoteInterpreter.java:213)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.interpret(LazyOpenInterpreter.java:93)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:212)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:171)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:326)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:178)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:292)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:745)\n","progressUpdateIntervalMs":500,"$$hashKey":"object:73"},{"text":"%pyspark\ndf_w_a.where(df_w_a.id == \"5wTAi7QkpP6kp8a54lmTOq\").show(10)","dateUpdated":"Jan 16, 2021 7:05:58 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610798658109_-1845356896","id":"20210116-120418_2133626082","result":"org.apache.thrift.transport.TTransportException","dateCreated":"Jan 16, 2021 12:04:18 PM","dateStarted":"Jan 16, 2021 7:13:00 PM","dateFinished":"Jan 16, 2021 7:13:53 PM","status":"ERROR","errorMessage":"org.apache.thrift.transport.TTransportException\n\tat org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)\n\tat org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)\n\tat org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:429)\n\tat org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:318)\n\tat org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:219)\n\tat org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:69)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$Client.recv_interpret(RemoteInterpreterService.java:220)\n\tat org.apache.zeppelin.interpreter.thrift.RemoteInterpreterService$Client.interpret(RemoteInterpreterService.java:205)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.interpret(RemoteInterpreter.java:213)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.interpret(LazyOpenInterpreter.java:93)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:212)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:171)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:326)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:178)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:292)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:745)\n","progressUpdateIntervalMs":500,"$$hashKey":"object:74"},{"text":"%pyspark\nprint(df_f.show())","dateUpdated":"Jan 16, 2021 7:05:58 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610813301623_417465086","id":"20210116-160821_728107688","result":"org.apache.zeppelin.interpreter.InterpreterException: org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused","dateCreated":"Jan 16, 2021 4:08:21 PM","dateStarted":"Jan 16, 2021 7:13:53 PM","dateFinished":"Jan 16, 2021 7:13:53 PM","status":"ERROR","errorMessage":"java.net.ConnectException: Connection refused\n\tat java.net.PlainSocketImpl.socketConnect(Native Method)\n\tat java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)\n\tat java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)\n\tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n\tat java.net.Socket.connect(Socket.java:579)\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:182)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:51)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:37)\n\tat org.apache.commons.pool2.BasePooledObjectFactory.makeObject(BasePooledObjectFactory.java:60)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:861)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterProcess.getClient(RemoteInterpreterProcess.java:142)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.interpret(RemoteInterpreter.java:193)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.interpret(LazyOpenInterpreter.java:93)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:212)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:171)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:326)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:178)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:292)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:745)\n","progressUpdateIntervalMs":500,"$$hashKey":"object:75"},{"text":"%pyspark\ndf_f.write.mode('overwrite').parquet('/user/bigdata_music/spark_etl_view/view.parquet')","dateUpdated":"Jan 16, 2021 7:05:58 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610814921675_501521700","id":"20210116-163521_311874592","result":"org.apache.zeppelin.interpreter.InterpreterException: org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused","dateCreated":"Jan 16, 2021 4:35:21 PM","dateStarted":"Jan 16, 2021 7:13:54 PM","dateFinished":"Jan 16, 2021 7:13:54 PM","status":"ERROR","errorMessage":"java.net.ConnectException: Connection refused\n\tat java.net.PlainSocketImpl.socketConnect(Native Method)\n\tat java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)\n\tat java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)\n\tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n\tat java.net.Socket.connect(Socket.java:579)\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:182)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:51)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:37)\n\tat org.apache.commons.pool2.BasePooledObjectFactory.makeObject(BasePooledObjectFactory.java:60)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:861)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterProcess.getClient(RemoteInterpreterProcess.java:142)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.interpret(RemoteInterpreter.java:193)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.interpret(LazyOpenInterpreter.java:93)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:212)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:171)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:326)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:178)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:292)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:745)\n","progressUpdateIntervalMs":500,"$$hashKey":"object:76"},{"text":"val sqlContext = new org.apache.spark.sql.SQLContext(sc)\n\nval df_f = sqlContext.read.parquet(\"/user/bigdata_music/spark_etl_view/view.parquet\")\n\ndf_f.toDF(). registerTempTable(\"big_data_table\")","dateUpdated":"Jan 16, 2021 7:05:58 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610813330108_1099655534","id":"20210116-160850_919418980","result":"org.apache.zeppelin.interpreter.InterpreterException: org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused","dateCreated":"Jan 16, 2021 4:08:50 PM","dateStarted":"Jan 16, 2021 7:13:54 PM","dateFinished":"Jan 16, 2021 7:13:54 PM","status":"ERROR","errorMessage":"java.net.ConnectException: Connection refused\n\tat java.net.PlainSocketImpl.socketConnect(Native Method)\n\tat java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)\n\tat java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)\n\tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n\tat java.net.Socket.connect(Socket.java:579)\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:182)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:51)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:37)\n\tat org.apache.commons.pool2.BasePooledObjectFactory.makeObject(BasePooledObjectFactory.java:60)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:861)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterProcess.getClient(RemoteInterpreterProcess.java:142)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.getFormType(RemoteInterpreter.java:271)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.getFormType(LazyOpenInterpreter.java:104)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:199)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:171)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:326)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:178)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:292)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:745)\n","progressUpdateIntervalMs":500,"$$hashKey":"object:77"},{"text":"","dateUpdated":"Jan 16, 2021 7:05:58 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610816014016_-76965502","id":"20210116-165334_318246663","result":"org.apache.zeppelin.interpreter.InterpreterException: org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused","dateCreated":"Jan 16, 2021 4:53:34 PM","dateStarted":"Jan 16, 2021 7:13:54 PM","dateFinished":"Jan 16, 2021 7:13:54 PM","status":"ERROR","errorMessage":"java.net.ConnectException: Connection refused\n\tat java.net.PlainSocketImpl.socketConnect(Native Method)\n\tat java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)\n\tat java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)\n\tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n\tat java.net.Socket.connect(Socket.java:579)\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:182)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:51)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:37)\n\tat org.apache.commons.pool2.BasePooledObjectFactory.makeObject(BasePooledObjectFactory.java:60)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:861)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterProcess.getClient(RemoteInterpreterProcess.java:142)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.getFormType(RemoteInterpreter.java:271)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.getFormType(LazyOpenInterpreter.java:104)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:199)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:171)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:326)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:178)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:292)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:745)\n","progressUpdateIntervalMs":500,"$$hashKey":"object:78"},{"text":"%pyspark\nprint(df_f.where(df_f.id == \"5wTAi7QkpP6kp8a54lmTOq\").show(15))","dateUpdated":"Jan 16, 2021 7:05:59 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610746148352_-1347010797","id":"20210115-212908_463349811","result":"org.apache.zeppelin.interpreter.InterpreterException: org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused","dateCreated":"Jan 15, 2021 9:29:08 PM","dateStarted":"Jan 16, 2021 7:13:54 PM","dateFinished":"Jan 16, 2021 7:13:54 PM","status":"ERROR","errorMessage":"java.net.ConnectException: Connection refused\n\tat java.net.PlainSocketImpl.socketConnect(Native Method)\n\tat java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)\n\tat java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)\n\tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n\tat java.net.Socket.connect(Socket.java:579)\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:182)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:51)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:37)\n\tat org.apache.commons.pool2.BasePooledObjectFactory.makeObject(BasePooledObjectFactory.java:60)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:861)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterProcess.getClient(RemoteInterpreterProcess.java:142)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.interpret(RemoteInterpreter.java:193)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.interpret(LazyOpenInterpreter.java:93)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:212)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:171)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:326)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:178)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:292)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:745)\n","progressUpdateIntervalMs":500,"$$hashKey":"object:79"},{"text":"%sql\nselect * from big_data_table limit 10","dateUpdated":"Jan 16, 2021 7:05:59 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610798373474_1858622410","id":"20210116-115933_1959479916","result":"org.apache.zeppelin.interpreter.InterpreterException: org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused","dateCreated":"Jan 16, 2021 11:59:33 AM","dateStarted":"Jan 16, 2021 7:13:54 PM","dateFinished":"Jan 16, 2021 7:13:54 PM","status":"ERROR","errorMessage":"java.net.ConnectException: Connection refused\n\tat java.net.PlainSocketImpl.socketConnect(Native Method)\n\tat java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)\n\tat java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)\n\tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n\tat java.net.Socket.connect(Socket.java:579)\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:182)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:51)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:37)\n\tat org.apache.commons.pool2.BasePooledObjectFactory.makeObject(BasePooledObjectFactory.java:60)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:861)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterProcess.getClient(RemoteInterpreterProcess.java:142)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.getFormType(RemoteInterpreter.java:271)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.getFormType(LazyOpenInterpreter.java:104)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:199)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:171)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:326)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:178)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:292)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:745)\n","progressUpdateIntervalMs":500,"$$hashKey":"object:80"},{"dateUpdated":"Jan 16, 2021 7:05:59 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1610812493105_112582492","id":"20210116-155453_291284158","result":"org.apache.zeppelin.interpreter.InterpreterException: org.apache.thrift.transport.TTransportException: java.net.ConnectException: Connection refused","dateCreated":"Jan 16, 2021 3:54:53 PM","dateStarted":"Jan 16, 2021 7:13:55 PM","dateFinished":"Jan 16, 2021 7:13:55 PM","status":"ERROR","errorMessage":"java.net.ConnectException: Connection refused\n\tat java.net.PlainSocketImpl.socketConnect(Native Method)\n\tat java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)\n\tat java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)\n\tat java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)\n\tat java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)\n\tat java.net.Socket.connect(Socket.java:579)\n\tat org.apache.thrift.transport.TSocket.open(TSocket.java:182)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:51)\n\tat org.apache.zeppelin.interpreter.remote.ClientFactory.create(ClientFactory.java:37)\n\tat org.apache.commons.pool2.BasePooledObjectFactory.makeObject(BasePooledObjectFactory.java:60)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:861)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:435)\n\tat org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:363)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterProcess.getClient(RemoteInterpreterProcess.java:142)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreter.getFormType(RemoteInterpreter.java:271)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.getFormType(LazyOpenInterpreter.java:104)\n\tat org.apache.zeppelin.notebook.Paragraph.jobRun(Paragraph.java:199)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:171)\n\tat org.apache.zeppelin.scheduler.RemoteScheduler$JobRunner.run(RemoteScheduler.java:326)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:262)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:178)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:292)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\tat java.lang.Thread.run(Thread.java:745)\n","progressUpdateIntervalMs":500,"$$hashKey":"object:81"}],"name":"21_01_02_01","id":"2FTMPDWKT","angularObjects":{"2BMW1WWJ1":[]},"config":{"looknfeel":"default"},"info":{}}